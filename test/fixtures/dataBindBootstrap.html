<!-- For test server rendered no visual change but event bindings -->
<section class="search-bar" data-bind-comp="search-bar" data-server-rendered>
    <div class="container">
        <form id="search-form" data-bind-submit="onSearchSubmit">
            <div class="form-row">
                <div class="col-8" id="scrollable-dropdown-menu">
                    <input id="searchWord" name="searchWord" type="text" class="form-control typeahead" value="" data-bind-model="searchWord" data-bind-change="onSearchWordChange" required>
                    <label for="searchWord" class="search-bar__label search-bar__label--large">I'm looking for...</label>
                    <span class="search-bar__focus-bar"></span>
                </div>
                <div class="col-3 input-group">
                    <span class="oi search-bar__map-marker" data-glyph="map-marker"></span>
                    <input id="location" name="location" type="text" class="form-control" data-bind-model="searchLocation" data-bind-change="onSearchLocationChange" placeholder="Location" value="Sydney" aria-label="Location">
                    <span class="search-bar__focus-bar"></span>
                </div>
                <div class="col">
                    <button class="btn btn-success search-bar__btn" type="submit">
                        <span class="spinner spinner--search" data-bind-show="searching"></span>
                        <span data-bind-show="!searching">
                            <span class="sr-only">Search</span>
                            <span class="oi" data-glyph="magnifying-glass" aria-hidden="true"></span>
                        </span>
                    </button>
                </div>
            </div>
        </form>
    </div>
</section>

<!-- For test template binding with data-server-rendered and append -->
<section class="container search-result" data-bind-comp="search-results-component" data-server-rendered>
    <h4 class="text-center section-title" data-bind-text="searchResultTitle">Featured service providers</h4>
    <div id="search-result-columns" class="card-columns" data-bind-tmp="{id: 'searchResultItem', data: '$root', append: true}">
        <div class="card result-item" data-index="0">
            <img class="card-img-top result-item__img" src="images/pic-home.jpg" alt="Card image">
            <div class="card-body">
                <h4 class="card-title">Card title that wraps to a new line</h4>
                <p class="card-text">This is a longer card with supporting text below as a natural lead-in to additional content. This content is a little bit longer.</p>
            </div>
            <div class="card-footer result-item__footer">
                <div class="result-item__icon-checkbox-wrap">
                    <input class="result-item__icon result-item__icon-checkbox" type="checkbox" id="adid0" name="adid0" data-index="0" data-bind-model="searchResults[0].selected" data-bind-change="onAdMessageCheck">
                    <label for="adid0" class="oi result-item__icon-checkbox-label" data-glyph="task" aria-label="Message this seller"></label>
                </div>
                <span class="oi result-item__icon" data-glyph="bookmark" data-bind-css="searchResults[0].bookmarkedCss" data-bind-click="onAdBookmarkClick" data-index="0"></span>
                <span class="oi result-item__icon" data-glyph="thumb-up">99</span>
            </div>
        </div>

        <div class="card result-item" data-index="1">
            <div class="card-body">
                <h4 class="card-title">Card title</h4>
                <p class="card-text">This is a wider card with supporting text below as a natural lead-in to additional content. This card has even longer content than the first to show that equal height action.</p>
            </div>
            <div class="card-footer result-item__footer">
                <div class="result-item__icon-checkbox-wrap">
                    <input class="result-item__icon result-item__icon-checkbox" type="checkbox" id="adid1" name="adid1" data-index="1" data-bind-model="searchResults[1].selected" data-bind-change="onAdMessageCheck">
                    <label for="adid1" class="oi result-item__icon-checkbox-label" data-glyph="task" aria-label="Message this seller"></label>
                </div>
                <span class="oi result-item__icon" data-glyph="bookmark" data-bind-css="searchResults[1].bookmarkedCss" data-bind-click="onAdBookmarkClick" data-index="1"></span>
                <span class="oi result-item__icon" data-glyph="thumb-up">9</span>
            </div>
        </div>

        <div class="card result-item" data-index="2">
            <img class="card-img-top result-item__img" src="images/pic-deck.jpg" alt="Card image">
            <div class="card-body">
                <h4 class="card-title">Card title</h4>
                <p class="card-text">This card has supporting text below as a natural lead-in to additional content.</p>
            </div>
            <div class="card-footer result-item__footer">
                <div class="result-item__icon-checkbox-wrap">
                    <input class="result-item__icon result-item__icon-checkbox" type="checkbox" id="adid2" name="adid2" data-index="2" data-bind-model="searchResults[2].selected" data-bind-change="onAdMessageCheck">
                    <label for="adid2" class="oi result-item__icon-checkbox-label" data-glyph="task" aria-label="Message this seller"></label>
                </div>
                <span class="oi result-item__icon" data-glyph="bookmark" data-bind-css="searchResults[2].bookmarkedCss" data-bind-click="onAdBookmarkClick" data-index="2"></span>
                <span class="oi result-item__icon" data-glyph="thumb-up">24</span>
            </div>
        </div>
    </div>

    <button type="button" class="btn btn-outline-secondary search-result__btn-more" data-bind-show="showMore" data-bind-click="onMoreResults">
        <span class="spinner" data-bind-show="loading"></span>
        <span data-bind-show="!loading">More</span>
    </button>

    <div class="mass-message__trigger-wrap" data-bind-css="messageTriggerCss" data-bind-click="onMessageTriggerClick" data-toggle="modal" data-target="#message-modal">
        <div class="mass-message__trigger">
            <span class="oi mass-message__trigger-icon" data-glyph="pencil" aria-label="write message"></span>
        </div>
    </div>
</section>

<div id="message-modal" class="modal fade" data-bind-comp="message-dialog-component" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg message-modal" role="document">
        <div class="modal-content message-modal__content">
            <form id="formMessage" data-bind-submit="onMessageSubmit">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Send Message</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div data-bind-show="!sendingMessage">
                        <div class="alert alert-primary" role="alert">
                            <h4 class="alert-heading">Well done!</h4>
                            <p>Send a single message to all <strong data-bind-text="numSelectedProviders"></strong> selected service providers with just one click.</p>
                            <p>This message will be send to <span data-bind-text="selectedProviders"></span></p>
                            <hr>
                            <p class="mb-0"><strong>Tips:</strong> Provide details of your job request to have more accurate quotes.</p>
                        </div>
                        <div class="form-group">
                            <label for="message">Message</label>
                            <textarea class="form-control" id="message" name="message" rows="8" required></textarea>
                        </div>
                    </div>
                    <div data-bind-show="sendingMessage" class="message-modal__content-success">
                        <span class="oi message-modal__icon-success" data-glyph="check"></span>
                        <p>Your message successfully send to <span data-bind-text="selectedProviders"></span></p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-success message-modal__btn-cta" data-bind-show="!sendingMessage">Send</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- searchResultItem test with deep nested templates -->
<template id="searchResultItem">
    <div 
        class="card result-item" 
        data-bind-css="$data.highlightCss"
        data-bind-for="result of $root.searchResults"
    >
        <img 
            data-bind-if="result.image"
            data-bind-attr="$root.getImgAttr($data)"
            class="card-img-top result-item__img" 
        >
        <div 
            class="card-body"
            data-bind-tmp="{id: 'searchResultItemBody', data: 'result'}"
        ></div>
        <div data-bind-tmp="{id: 'searchResultItemFooter', data: 'result'}" ></div>
    </div>
</template>

<template id="searchResultItemBody">
    <h4 class="card-title" data-bind-text="$data.title"></h4>
    <p class="card-text" data-bind-text="$data.description"></p>
</template>

<template id="searchResultItemFooter">
    <div class="card-footer result-item__footer">
        <div class="result-item__icon-checkbox-wrap">
            <input 
                class="result-item__icon result-item__icon-checkbox"
                type="checkbox" 
                data-bind-attr="$root.getMessageCheckBoxAttr($data)"
                data-bind-model="$data.selected" 
                data-bind-change="$root.onAdMessageCheck"
            >
            <label 
                data-bind-attr="$root.getMessageCheckBoxLabelAttr($data)"
                class="oi result-item__icon-checkbox-label" 
                data-glyph="task" 
                aria-label="Message this seller"
            ></label>
        </div>
        <span 
            data-bind-tmp="{id: 'searchResultItemBookMark', data: '$data'}" 
        ></span>
    </div>
</template>

<template id="searchResultItemBookMark">
    <span 
        class="oi result-item__icon" 
        data-glyph="bookmark" 
        data-bind-css="$data.bookmarkedCss" 
        data-bind-click="onAdBookmarkClick" 
    ></span>
    <span 
        class="oi result-item__icon" 
        data-glyph="thumb-up"
        data-bind-text="$data.numLikes"
    ></span>
</template>